
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://teldh.github.io/ekeel/docs/codebase/EKEELVideoAnnotation/main/">
      
      
        <link rel="prev" href="../forms/user/">
      
      
        <link rel="next" href="../media/audio/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>main - EKEEL - Empowering Knowledge Extraction to Empower Learners</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Source Serif Pro";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#main" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="EKEEL - Empowering Knowledge Extraction to Empower Learners" class="md-header__button md-logo" aria-label="EKEEL - Empowering Knowledge Extraction to Empower Learners" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EKEEL - Empowering Knowledge Extraction to Empower Learners
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              main
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/teldh/ekeel" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Homepage

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../prerequisites/conda/" class="md-tabs__link">
          
  
  Deploy

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../burst/extractor/" class="md-tabs__link">
          
  
  Codebase

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../prerequisites/mkdocs/" class="md-tabs__link">
        
  
    
  
  Mkdocs

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="EKEEL - Empowering Knowledge Extraction to Empower Learners" class="md-nav__button md-logo" aria-label="EKEEL - Empowering Knowledge Extraction to Empower Learners" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EKEEL - Empowering Knowledge Extraction to Empower Learners
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/teldh/ekeel" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homepage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deploy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Deploy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Local
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Local
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/conda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../platforms/annotator/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../platforms/augmentator/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Augmentator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Remote
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Remote
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/linux-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../remote/pull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Codebase Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../platforms/annotator/deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../platforms/augmentator/deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Augmentator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../platforms/annotator/transcriber/deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transcriber
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Codebase
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Codebase
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    EKEELVideoAnnotation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            EKEELVideoAnnotation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    burst
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            burst
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burst/extractor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    extractor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burst/kleinberg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kleinberg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burst/prototype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prototype
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burst/results_processor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    results_processor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burst/weight/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weight
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    database
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/mongo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mongo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" >
        
          
          <label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    embedding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            embedding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../embedding/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_7" >
        
          
          <label class="md-nav__link" for="__nav_3_1_7" id="__nav_3_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    forms
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_7">
            <span class="md-nav__icon md-icon"></span>
            forms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forms/form/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forms/mail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forms/user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    user
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    main
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    main
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.burst" class="md-nav__link">
    <span class="md-ellipsis">
      burst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.burst_launch" class="md-nav__link">
    <span class="md-ellipsis">
      burst_launch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.confirm_code" class="md-nav__link">
    <span class="md-ellipsis">
      confirm_code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.confirm_email" class="md-nav__link">
    <span class="md-ellipsis">
      confirm_email
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.delete_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      delete_annotation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.delete_video" class="md-nav__link">
    <span class="md-ellipsis">
      delete_video
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.forgot_password" class="md-nav__link">
    <span class="md-ellipsis">
      forgot_password
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.get_concept_vocabulary" class="md-nav__link">
    <span class="md-ellipsis">
      get_concept_vocabulary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.gold_standard" class="md-nav__link">
    <span class="md-ellipsis">
      gold_standard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.index" class="md-nav__link">
    <span class="md-ellipsis">
      index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.lemmatize_term" class="md-nav__link">
    <span class="md-ellipsis">
      lemmatize_term
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.login" class="md-nav__link">
    <span class="md-ellipsis">
      login
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.logout" class="md-nav__link">
    <span class="md-ellipsis">
      logout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.password_reset" class="md-nav__link">
    <span class="md-ellipsis">
      password_reset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.prepare_annotated_graph" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_annotated_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.upload_annotated_graph" class="md-nav__link">
    <span class="md-ellipsis">
      upload_annotated_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.video_segmentation_refinement" class="md-nav__link">
    <span class="md-ellipsis">
      video_segmentation_refinement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.video_selection" class="md-nav__link">
    <span class="md-ellipsis">
      video_selection
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          <label class="md-nav__link" for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    media
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            media
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../media/audio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    audio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../media/image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../media/segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../media/video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    video
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          <label class="md-nav__link" for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    metrics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/agreement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    agreement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_11" >
        
          
          <label class="md-nav__link" for="__nav_3_1_11" id="__nav_3_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    misc_unused
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_11">
            <span class="md-nav__icon md-icon"></span>
            misc_unused
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/Method_01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method_01
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/Method_02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method_02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/Method_03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method_03
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/Method_04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method_04
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/skos_synonyms_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skos_synonyms_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc_unused/wikipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wikipe
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12" >
        
          
          <label class="md-nav__link" for="__nav_3_1_12" id="__nav_3_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12">
            <span class="md-nav__icon md-icon"></span>
            models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/xgboost_adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xgboost_adapter
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_13" >
        
          
          <label class="md-nav__link" for="__nav_3_1_13" id="__nav_3_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ontology
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_13">
            <span class="md-nav__icon md-icon"></span>
            ontology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ontology/rdf_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdf_graph
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_14" >
        
          
          <label class="md-nav__link" for="__nav_3_1_14" id="__nav_3_1_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_14">
            <span class="md-nav__icon md-icon"></span>
            services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/NLP_API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP_API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_15" >
        
          
          <label class="md-nav__link" for="__nav_3_1_15" id="__nav_3_1_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    text_processor
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_15">
            <span class="md-nav__icon md-icon"></span>
            text_processor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text_processor/conll/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conll
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text_processor/locales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text_processor/synonyms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synonyms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text_processor/words/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    words
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transcribe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transcribe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_17" >
        
          
          <label class="md-nav__link" for="__nav_3_1_17" id="__nav_3_1_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_17">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/itertools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    itertools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    structures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    EKEELVideoAugmentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            EKEELVideoAugmentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    src
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            src
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1_1" id="__nav_3_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    flask-server
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            flask-server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EKEELVideoAugmentation/src/flask-server/data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EKEELVideoAugmentation/src/flask-server/environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EKEELVideoAugmentation/src/flask-server/handle_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    handle_data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EKEELVideoAugmentation/src/flask-server/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mkdocs
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.burst" class="md-nav__link">
    <span class="md-ellipsis">
      burst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.burst_launch" class="md-nav__link">
    <span class="md-ellipsis">
      burst_launch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.confirm_code" class="md-nav__link">
    <span class="md-ellipsis">
      confirm_code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.confirm_email" class="md-nav__link">
    <span class="md-ellipsis">
      confirm_email
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.delete_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      delete_annotation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.delete_video" class="md-nav__link">
    <span class="md-ellipsis">
      delete_video
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.forgot_password" class="md-nav__link">
    <span class="md-ellipsis">
      forgot_password
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.get_concept_vocabulary" class="md-nav__link">
    <span class="md-ellipsis">
      get_concept_vocabulary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.gold_standard" class="md-nav__link">
    <span class="md-ellipsis">
      gold_standard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.index" class="md-nav__link">
    <span class="md-ellipsis">
      index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.lemmatize_term" class="md-nav__link">
    <span class="md-ellipsis">
      lemmatize_term
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.login" class="md-nav__link">
    <span class="md-ellipsis">
      login
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.logout" class="md-nav__link">
    <span class="md-ellipsis">
      logout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.password_reset" class="md-nav__link">
    <span class="md-ellipsis">
      password_reset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.prepare_annotated_graph" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_annotated_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.upload_annotated_graph" class="md-nav__link">
    <span class="md-ellipsis">
      upload_annotated_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.video_segmentation_refinement" class="md-nav__link">
    <span class="md-ellipsis">
      video_segmentation_refinement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.video_selection" class="md-nav__link">
    <span class="md-ellipsis">
      video_selection
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<div><h1 id="main">Main</h1>
<hr>


<div class="doc doc-object doc-module">



<a id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main"></a>
    <div class="doc doc-contents first">

        <p>EKEEL Video Annotation Server Backend</p>
<p>This module implements a Flask web server for video annotation and analysis.
It provides functionality for:</p>
<ul>
<li>
<p>User Management:</p>
<ul>
<li>Registration and authentication</li>
<li>Profile management</li>
</ul>
</li>
<li>
<p>Video Processing:</p>
<ul>
<li>YouTube video processing</li>
<li>Transcript extraction</li>
<li>Video segmentation</li>
</ul>
</li>
<li>
<p>Annotation Features:</p>
<ul>
<li>Manual concept mapping</li>
<li>Definition creation</li>
<li>Vocabulary management</li>
</ul>
</li>
<li>
<p>Analysis Tools:</p>
<ul>
<li>Burst analysis (automatic/semi-automatic)</li>
<li>Inter-annotator agreement</li>
<li>Gold standard creation</li>
<li>Linguistic analysis</li>
</ul>
</li>
<li>
<p>Data Management:</p>
<ul>
<li>MongoDB storage integration</li>
<li>JSON-LD export format</li>
<li>SKOS vocabulary support</li>
</ul>
</li>
</ul>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.analysis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">analysis</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle various types of annotation analysis requests.</p>
<p>This endpoint processes different types of analysis on video annotations:
- Data summary: Statistical analysis of concept maps and definitions
- Agreement: Compare annotations between two annotators
- Linguistic: Analyze linguistic properties of annotations
- Fleiss: Calculate inter-annotator agreement using Fleiss' kappa</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>analysis_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of analysis to perform:
- 'data_summary': Statistical summary
- 'agreement': Inter-annotator comparison
- 'linguistic': Linguistic analysis
- 'fleiss': Fleiss' kappa calculation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>video</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Video identifier for analysis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotator</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Annotator ID for data_summary and linguistic analysis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotator1</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First annotator ID for agreement analysis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotator2</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second annotator ID for agreement analysis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendered HTML template with analysis results:
- On GET: analysis_selection.html with video choices
- On POST: analysis_results.html with computed results</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/analysis'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">])</span>
<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle various types of annotation analysis requests.</span>

<span class="sd">    This endpoint processes different types of analysis on video annotations:</span>
<span class="sd">    - Data summary: Statistical analysis of concept maps and definitions</span>
<span class="sd">    - Agreement: Compare annotations between two annotators</span>
<span class="sd">    - Linguistic: Analyze linguistic properties of annotations</span>
<span class="sd">    - Fleiss: Calculate inter-annotator agreement using Fleiss' kappa</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    analysis_type : str</span>
<span class="sd">        Type of analysis to perform:</span>
<span class="sd">        - 'data_summary': Statistical summary</span>
<span class="sd">        - 'agreement': Inter-annotator comparison</span>
<span class="sd">        - 'linguistic': Linguistic analysis</span>
<span class="sd">        - 'fleiss': Fleiss' kappa calculation</span>
<span class="sd">    video : str</span>
<span class="sd">        Video identifier for analysis</span>
<span class="sd">    annotator : str, optional</span>
<span class="sd">        Annotator ID for data_summary and linguistic analysis</span>
<span class="sd">    annotator1 : str, optional</span>
<span class="sd">        First annotator ID for agreement analysis</span>
<span class="sd">    annotator2 : str, optional</span>
<span class="sd">        Second annotator ID for agreement analysis</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Rendered HTML template with analysis results:</span>
<span class="sd">        - On GET: analysis_selection.html with video choices</span>
<span class="sd">        - On POST: analysis_results.html with computed results</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::analysis() ******"</span><span class="p">)</span>

    <span class="n">video_choices</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_graphs_info</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">'POST'</span><span class="p">:</span>
        <span class="n">analysis_type</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"analysis_type"</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">analysis_type</span> <span class="o">==</span> <span class="s2">"data_summary"</span><span class="p">:</span>
            <span class="n">video_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"video"</span><span class="p">]</span>
            <span class="n">annotator_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"annotator"</span><span class="p">]</span>

            <span class="n">concept_map</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_concept_map</span><span class="p">(</span><span class="n">annotator_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>
            <span class="n">definitions</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_definitions</span><span class="p">(</span><span class="n">annotator_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="n">compute_data_summary</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">concept_map</span><span class="p">,</span> <span class="n">definitions</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">annotator_id</span> <span class="o">!=</span> <span class="s2">"Burst_Analysis"</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">annotator_id</span><span class="p">)</span>
                <span class="n">annotator</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">user</span><span class="p">[</span><span class="s2">"surname"</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">annotator</span> <span class="o">=</span> <span class="s2">"Burst"</span>

            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'analysis_results.html'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">annotator</span><span class="o">=</span><span class="n">annotator</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">video_choices</span><span class="p">[</span><span class="n">video_id</span><span class="p">][</span><span class="s2">"title"</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">analysis_type</span> <span class="o">==</span> <span class="s2">"agreement"</span><span class="p">:</span>
            <span class="n">video_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"video"</span><span class="p">]</span>
            <span class="n">annotator1_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"annotator1"</span><span class="p">]</span>
            <span class="n">annotator2_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"annotator2"</span><span class="p">]</span>

            <span class="n">concept_map1</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_concept_map</span><span class="p">(</span><span class="n">annotator1_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>
            <span class="n">concept_map2</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_concept_map</span><span class="p">(</span><span class="n">annotator2_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="n">compute_agreement</span><span class="p">(</span><span class="n">concept_map1</span><span class="p">,</span> <span class="n">concept_map2</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">annotator1_id</span> <span class="o">!=</span> <span class="s2">"Burst_Analysis"</span><span class="p">:</span>
                <span class="n">u1</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">annotator1_id</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">"annotator1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">u1</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">u1</span><span class="p">[</span><span class="s2">"surname"</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">"annotator1"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Burst"</span>

            <span class="k">if</span> <span class="n">annotator2_id</span> <span class="o">!=</span> <span class="s2">"Burst_Analysis"</span><span class="p">:</span>
                <span class="n">u2</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">annotator2_id</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">"annotator2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">u2</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">u2</span><span class="p">[</span><span class="s2">"surname"</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">"annotator2"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Burst"</span>


            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'analysis_results.html'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">video_choices</span><span class="p">[</span><span class="n">video_id</span><span class="p">][</span><span class="s2">"title"</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">analysis_type</span> <span class="o">==</span> <span class="s2">"linguistic"</span><span class="p">:</span>
            <span class="n">video_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"video"</span><span class="p">]</span>
            <span class="n">annotator_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"annotator"</span><span class="p">]</span>

            <span class="n">results</span> <span class="o">=</span> <span class="n">linguistic_analysis</span><span class="p">(</span><span class="n">annotator_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'analysis_results.html'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">video_choices</span><span class="p">[</span><span class="n">video_id</span><span class="p">][</span><span class="s2">"title"</span><span class="p">])</span>


        <span class="k">elif</span> <span class="n">analysis_type</span> <span class="o">==</span> <span class="s2">"fleiss"</span><span class="p">:</span>
            <span class="n">video_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">"video"</span><span class="p">]</span>

            <span class="n">results</span> <span class="o">=</span> <span class="n">fleiss</span><span class="p">(</span><span class="n">video_id</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'analysis_results.html'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">analysis_type</span><span class="o">=</span><span class="n">analysis_type</span><span class="p">,</span>
                                   <span class="n">title</span><span class="o">=</span><span class="n">video_choices</span><span class="p">[</span><span class="n">video_id</span><span class="p">][</span><span class="s2">"title"</span><span class="p">])</span>

    <span class="n">videos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vid_id</span> <span class="ow">in</span> <span class="n">video_choices</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">video_choices</span><span class="p">[</span><span class="n">vid_id</span><span class="p">]</span>
        <span class="n">video</span><span class="p">[</span><span class="s2">"video_id"</span><span class="p">]</span> <span class="o">=</span> <span class="n">vid_id</span>
        <span class="n">videos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'analysis_selection.html'</span><span class="p">,</span>  <span class="n">videos</span><span class="o">=</span><span class="n">videos</span><span class="p">)</span> <span class="c1">#form=form,</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.burst" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">burst</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process burst analysis requests for video annotations.</p>
<p>This endpoint handles burst analysis of videos, which can be either:
- Semi-automatic: Extracts transcript and processes text for annotations
- Automatic: Extracts keywords only</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>YouTube video ID from form</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Analysis type from form:
- 'semi': Semi-automatic analysis with transcript
- 'auto': Automatic analysis with keywords only</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On GET: 
    Rendered 'burst.html' template with:
    - form : BurstForm
        Form for burst analysis parameters
    - videos : list
        Available videos for analysis
On POST:
    Rendered 'burst_results.html' template with:
    - result : list
        Processed subtitles (semi-automatic only)
    - video_id : str
        YouTube video identifier
    - language : str
        Detected video language
    - concepts : list
        Extracted keywords
    - title : str
        Video title
    - lemmatized_subtitles : list
        Processed subtitle text (semi-automatic only)
    - type : str
        Analysis type performed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/burst'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">])</span>
<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">burst</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Process burst analysis requests for video annotations.</span>

<span class="sd">    This endpoint handles burst analysis of videos, which can be either:</span>
<span class="sd">    - Semi-automatic: Extracts transcript and processes text for annotations</span>
<span class="sd">    - Automatic: Extracts keywords only</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    url : str</span>
<span class="sd">        YouTube video ID from form</span>
<span class="sd">    type : str</span>
<span class="sd">        Analysis type from form:</span>
<span class="sd">        - 'semi': Semi-automatic analysis with transcript</span>
<span class="sd">        - 'auto': Automatic analysis with keywords only</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        On GET: </span>
<span class="sd">            Rendered 'burst.html' template with:</span>
<span class="sd">            - form : BurstForm</span>
<span class="sd">                Form for burst analysis parameters</span>
<span class="sd">            - videos : list</span>
<span class="sd">                Available videos for analysis</span>
<span class="sd">        On POST:</span>
<span class="sd">            Rendered 'burst_results.html' template with:</span>
<span class="sd">            - result : list</span>
<span class="sd">                Processed subtitles (semi-automatic only)</span>
<span class="sd">            - video_id : str</span>
<span class="sd">                YouTube video identifier</span>
<span class="sd">            - language : str</span>
<span class="sd">                Detected video language</span>
<span class="sd">            - concepts : list</span>
<span class="sd">                Extracted keywords</span>
<span class="sd">            - title : str</span>
<span class="sd">                Video title</span>
<span class="sd">            - lemmatized_subtitles : list</span>
<span class="sd">                Processed subtitle text (semi-automatic only)</span>
<span class="sd">            - type : str</span>
<span class="sd">                Analysis type performed</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::burst() ******"</span><span class="p">)</span>

    <span class="c1">#form = addVideoForm()</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">BurstForm</span><span class="p">()</span>
    <span class="n">videos</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_videos</span><span class="p">([</span><span class="s2">"video_id"</span><span class="p">,</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"creator"</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>

        <span class="n">video_id</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">data</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">VideoAnalyzer</span><span class="p">(</span><span class="sa">f</span><span class="s2">"https://youtu.be/</span><span class="si">{</span><span class="n">video_id</span><span class="si">}</span><span class="s2">"</span><span class="p">,{</span><span class="s2">"language"</span><span class="p">,</span><span class="s2">"transcript_data"</span><span class="p">})</span>
        <span class="c1">#text = SemanticText(get_text(video_id), video.identify_language())      </span>
        <span class="c1">#conll_sentences = conll_gen(video_id, text)</span>
        <span class="n">title</span><span class="p">,</span> <span class="n">keywords</span> <span class="o">=</span> <span class="n">get_real_keywords</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">annotator_id</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span><span class="p">)</span>

        <span class="c1"># semi-automatic extraction</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="s2">"semi"</span><span class="p">:</span>

            <span class="n">video</span><span class="o">.</span><span class="n">request_transcript</span><span class="p">()</span>
            <span class="n">subtitles</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"text"</span><span class="p">]</span>
            <span class="c1">#if video.data["transcript_data"]["is_whisper_transcribed"]:</span>
            <span class="c1">#all_lemmas = set(video._get_words_lemma().values())</span>
            <span class="n">lemmatized_subtitles</span> <span class="o">=</span> <span class="n">html_interactable_transcript_word_level</span><span class="p">(</span><span class="n">subtitles</span><span class="p">)</span>
            <span class="c1">#else:</span>
            <span class="c1">#    lemmatized_subtitles, all_lemmas = html_interactable_transcript_legacy(subtitles,video.data["language"], concepts=keywords)</span>

            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'burst_results.html'</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">subtitles</span><span class="p">,</span> <span class="n">video_id</span><span class="o">=</span><span class="n">video_id</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">video</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"language"</span><span class="p">],</span> <span class="n">concepts</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
                                   <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">lemmatized_subtitles</span><span class="o">=</span><span class="n">lemmatized_subtitles</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"semi"</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'burst_results.html'</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="p">[],</span> <span class="n">video_id</span><span class="o">=</span><span class="n">video_id</span><span class="p">,</span><span class="n">language</span><span class="o">=</span><span class="n">video</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"language"</span><span class="p">],</span> <span class="n">concepts</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                <span class="n">lemmatized_subtitles</span><span class="o">=</span><span class="p">[],</span> <span class="nb">type</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'burst.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">videos</span><span class="o">=</span><span class="n">videos</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.burst_launch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">burst_launch</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process and store burst analysis results with optional synonym expansion.</p>
<p>This endpoint handles the processing of burst analysis results, storing them
in the database, and computing comparison metrics with existing annotations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON request data containing:
- id : str
    Video identifier
- concepts : list
    List of extracted concepts
- conceptVocabulary : dict
    Mapping of concepts to synonyms
- syn_burst : bool
    Whether to include synonym expansion
- burst_type : str
    Type of burst analysis ('auto' or 'semi')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- concepts : list
    Processed concept list
- concept_map : dict
    Generated concept relationships
- definitions : dict
    Concept definitions
- data_summary : dict
    Statistical summary of results
- downloadable_jsonld_graph : dict
    JSON-LD formatted graph data
- agreement : dict
    Comparison metrics including:
    - name : str
        Annotator name
    - K : float
        Agreement score
    - VEO : float
        Vector embedding overlap
    - GED : float
        Graph edit distance
    - pageRank : float
        PageRank similarity
    - LO : float
        Learning outcome score
    - PN : float
        Prerequisite network score
- can_be_refined : bool
    Whether video supports refinement</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/burst_launch'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">burst_launch</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Process and store burst analysis results with optional synonym expansion.</span>

<span class="sd">    This endpoint handles the processing of burst analysis results, storing them</span>
<span class="sd">    in the database, and computing comparison metrics with existing annotations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict</span>
<span class="sd">        JSON request data containing:</span>
<span class="sd">        - id : str</span>
<span class="sd">            Video identifier</span>
<span class="sd">        - concepts : list</span>
<span class="sd">            List of extracted concepts</span>
<span class="sd">        - conceptVocabulary : dict</span>
<span class="sd">            Mapping of concepts to synonyms</span>
<span class="sd">        - syn_burst : bool</span>
<span class="sd">            Whether to include synonym expansion</span>
<span class="sd">        - burst_type : str</span>
<span class="sd">            Type of burst analysis ('auto' or 'semi')</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - concepts : list</span>
<span class="sd">            Processed concept list</span>
<span class="sd">        - concept_map : dict</span>
<span class="sd">            Generated concept relationships</span>
<span class="sd">        - definitions : dict</span>
<span class="sd">            Concept definitions</span>
<span class="sd">        - data_summary : dict</span>
<span class="sd">            Statistical summary of results</span>
<span class="sd">        - downloadable_jsonld_graph : dict</span>
<span class="sd">            JSON-LD formatted graph data</span>
<span class="sd">        - agreement : dict</span>
<span class="sd">            Comparison metrics including:</span>
<span class="sd">            - name : str</span>
<span class="sd">                Annotator name</span>
<span class="sd">            - K : float</span>
<span class="sd">                Agreement score</span>
<span class="sd">            - VEO : float</span>
<span class="sd">                Vector embedding overlap</span>
<span class="sd">            - GED : float</span>
<span class="sd">                Graph edit distance</span>
<span class="sd">            - pageRank : float</span>
<span class="sd">                PageRank similarity</span>
<span class="sd">            - LO : float</span>
<span class="sd">                Learning outcome score</span>
<span class="sd">            - PN : float</span>
<span class="sd">                Prerequisite network score</span>
<span class="sd">        - can_be_refined : bool</span>
<span class="sd">            Whether video supports refinement</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::burst_launch() ******"</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>

    <span class="n">video_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span>
    <span class="n">concepts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"concepts"</span><span class="p">]</span>
    <span class="n">concept_vocabulary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"conceptVocabulary"</span><span class="p">]</span>
    <span class="n">syn_burst</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"syn_burst"</span><span class="p">]</span>
    <span class="n">burst_type</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"burst_type"</span><span class="p">]</span>    

    <span class="c1"># select burst type</span>
    <span class="k">if</span> <span class="n">syn_burst</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Starting Burst "</span> <span class="o">+</span> <span class="n">burst_type</span> <span class="o">+</span> <span class="s2">" with synonyms"</span><span class="p">)</span>
        <span class="n">concept_map</span><span class="p">,</span><span class="n">definitions</span> <span class="o">=</span> <span class="n">burst_extraction_with_synonyms</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span> <span class="n">concepts</span><span class="p">,</span> <span class="n">concept_vocabulary</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Starting Burst "</span> <span class="o">+</span> <span class="n">burst_type</span><span class="p">)</span>
        <span class="n">concept_map</span><span class="p">,</span><span class="n">definitions</span> <span class="o">=</span> <span class="n">burst_extraction</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">concepts</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">burst_type</span> <span class="o">==</span> <span class="s2">"semi"</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">complete_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span><span class="s2">"_"</span><span class="p">)</span><span class="o">+</span><span class="s2">"_Burst_Analysis"</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">complete_name</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">email</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="s2">"Burst_Analysis"</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">user</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">user</span>
    <span class="n">burst_graph</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_graph</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">video_id</span><span class="p">)</span>

    <span class="c1"># saving burst_graph on db if not already present</span>
    <span class="k">if</span> <span class="n">burst_graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Saving Burst Graph on DB..."</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span><span class="n">burst_graph</span> <span class="o">=</span> <span class="n">create_burst_graph</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">definitions</span><span class="p">,</span><span class="n">concept_map</span><span class="p">)</span>
        <span class="n">local_vocabulary</span> <span class="o">=</span> <span class="n">create_local_vocabulary</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">concept_vocabulary</span><span class="p">)</span>
        <span class="n">skos_concepts</span> <span class="o">=</span> <span class="n">local_vocabulary</span><span class="p">[</span><span class="s2">"skos:member"</span><span class="p">]</span>
        <span class="n">downloadable_jsonld_graph</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"@context"</span><span class="p">:</span><span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@context"</span><span class="p">],</span><span class="s2">"@graph"</span><span class="p">:</span><span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@graph"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">+</span><span class="p">[</span><span class="n">local_vocabulary</span><span class="p">]}</span>
        <span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@graph"</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([{</span><span class="s2">"id"</span><span class="p">:</span><span class="n">concept</span><span class="p">[</span><span class="s2">"id"</span><span class="p">],</span><span class="s2">"type"</span><span class="p">:</span><span class="n">concept</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]}</span> <span class="k">for</span> <span class="n">concept</span> <span class="ow">in</span> <span class="n">skos_concepts</span><span class="p">])</span>
        <span class="n">mongo</span><span class="o">.</span><span class="n">insert_graph</span><span class="p">({</span> <span class="s2">"video_id"</span><span class="p">:</span><span class="n">video_id</span><span class="p">,</span>
                                <span class="s2">"annotator_id"</span><span class="p">:</span><span class="n">user</span><span class="p">,</span>
                                <span class="s2">"annotator_name"</span><span class="p">:</span><span class="n">name</span><span class="p">,</span>
                                <span class="s2">"email"</span><span class="p">:</span><span class="n">email</span><span class="p">,</span>
                                <span class="s2">"graph"</span><span class="p">:</span> <span class="n">burst_graph</span><span class="p">,</span>
                                <span class="s2">"conceptVocabulary"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"@context"</span><span class="p">:</span> <span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@context"</span><span class="p">],</span> 
                                                      <span class="s2">"@graph"</span><span class="p">:</span> <span class="n">skos_concepts</span><span class="p">}})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@graph"</span><span class="p">],</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">"id"</span><span class="p">][</span><span class="mi">3</span><span class="p">:])</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">"id"</span><span class="p">][</span><span class="mi">3</span><span class="p">:])</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="mi">1042</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">graph</span><span class="p">))):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s2">"id"</span><span class="p">])</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"concept_"</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">downloadable_jsonld_graph</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"@context"</span><span class="p">:</span><span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@context"</span><span class="p">],</span><span class="s2">"@graph"</span><span class="p">:</span><span class="n">graph</span><span class="o">+</span><span class="p">[</span><span class="n">create_local_vocabulary</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">concept_vocabulary</span><span class="p">)]}</span>

    <span class="n">data_summary</span> <span class="o">=</span> <span class="n">compute_data_summary</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">concept_map</span><span class="p">,</span><span class="n">definitions</span><span class="p">)</span>

    <span class="c1"># checks whether video has been segmented and if it is classifies ad slide video or not in order to enable refinement</span>
    <span class="n">video</span> <span class="o">=</span> <span class="n">VideoAnalyzer</span><span class="p">(</span><span class="s2">"https://www.youtube.com/watch?v="</span><span class="o">+</span><span class="n">video_id</span><span class="p">,{</span><span class="s2">"video_data"</span><span class="p">})</span>
    <span class="n">can_be_refined</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">is_slide_video</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">"slide_titles"</span> <span class="ow">in</span> <span class="n">video</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"video_data"</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="n">json</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"concepts"</span><span class="p">:</span> <span class="n">concepts</span><span class="p">,</span>
        <span class="s2">"concept_map"</span><span class="p">:</span> <span class="n">concept_map</span><span class="p">,</span>
        <span class="s2">"definitions"</span><span class="p">:</span> <span class="n">definitions</span><span class="p">,</span>
        <span class="s2">"data_summary"</span><span class="p">:</span> <span class="n">data_summary</span><span class="p">,</span>
        <span class="s2">"downloadable_jsonld_graph"</span><span class="p">:</span> <span class="n">downloadable_jsonld_graph</span><span class="p">,</span>
        <span class="s2">"agreement"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">"can_be_refined"</span><span class="p">:</span> <span class="n">can_be_refined</span>
    <span class="p">}</span>

    <span class="n">graphs</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_graphs_info</span><span class="p">(</span><span class="n">video_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">graphs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#first_annotator = graphs["annotators"][0]['id']</span>
        <span class="c1">#concept_map_annotator = db_mongo.get_concept_map(first_annotator, video_id)</span>

        <span class="n">annotators</span> <span class="o">=</span> <span class="n">graphs</span><span class="p">[</span><span class="s2">"annotators"</span><span class="p">]</span>
        <span class="c1"># [NOTE] used me as annotator instead of annotators[0] for testing keywords</span>
        <span class="n">my_id</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span>
        <span class="n">indx_annotator</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">annot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">annotators</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">annot</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">==</span><span class="n">my_id</span><span class="p">:</span>
                <span class="n">indx_annotator</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">break</span>
        <span class="n">indx_annotator</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">annotator</span> <span class="o">=</span> <span class="n">graphs</span><span class="p">[</span><span class="s2">"annotators"</span><span class="p">][</span><span class="n">indx_annotator</span><span class="p">][</span><span class="s1">'id'</span><span class="p">]</span>
        <span class="n">concept_map_annotator</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_concept_map</span><span class="p">(</span><span class="n">annotator</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>

        <span class="n">veo</span><span class="p">,</span> <span class="n">pageRank</span><span class="p">,</span> <span class="n">LO</span><span class="p">,</span> <span class="n">PN</span><span class="p">,</span> <span class="n">ged_sim</span> <span class="o">=</span> <span class="n">calculate_metrics</span><span class="p">(</span><span class="n">concept_map</span><span class="p">,</span> <span class="n">concept_map_annotator</span><span class="p">,</span> <span class="n">concepts</span><span class="p">)</span>

        <span class="n">json</span><span class="p">[</span><span class="s2">"agreement"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"name"</span><span class="p">:</span><span class="n">graphs</span><span class="p">[</span><span class="s2">"annotators"</span><span class="p">][</span><span class="n">indx_annotator</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"_"</span><span class="p">,</span><span class="s2">" "</span><span class="p">),</span>
            <span class="s2">"K"</span><span class="p">:</span> <span class="n">compute_agreement</span><span class="p">(</span><span class="n">concept_map</span><span class="p">,</span> <span class="n">concept_map_annotator</span><span class="p">)[</span><span class="s2">"agreement"</span><span class="p">],</span>
            <span class="s2">"VEO"</span><span class="p">:</span> <span class="n">veo</span><span class="p">,</span>
            <span class="s2">"GED"</span><span class="p">:</span> <span class="n">ged_sim</span><span class="p">,</span>
            <span class="s2">"pageRank"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">pageRank</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s2">"LO"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">LO</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s2">"PN"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">PN</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">json</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.confirm_code" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confirm_code</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the confirmation code process for new users.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the confirmation code page if the form is not submitted/valid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="werkzeug.wrappers.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A redirect response to the login page if the confirmation code is valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/confirm_code'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">confirm_code</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the confirmation code process for new users.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the confirmation code page if the form is not submitted/valid.</span>
<span class="sd">    werkzeug.wrappers.Response</span>
<span class="sd">        A redirect response to the login page if the confirmation code is valid.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::confirm_code() ******"</span><span class="p">)</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">ConfirmCodeForm</span><span class="p">()</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s1">'mail'</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>

        <span class="n">code</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">data</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">unverified_users</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s2">"email"</span><span class="p">:</span> <span class="n">email</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">),</span> <span class="n">user</span><span class="p">[</span><span class="s2">"code_on_creation_hash"</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)):</span>

            <span class="n">new_user</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">'name'</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s2">"name"</span><span class="p">],</span>
                <span class="s1">'surname'</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s2">"surname"</span><span class="p">],</span>
                <span class="s1">'email'</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s2">"email"</span><span class="p">],</span>
                <span class="s1">'password_hash'</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s2">"password_hash"</span><span class="p">],</span>
                <span class="s1">'video_history_list'</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span>
            <span class="c1"># users.insert_one(new_user)</span>
            <span class="n">unverified_users</span><span class="o">.</span><span class="n">delete_one</span><span class="p">({</span><span class="s2">"email"</span><span class="p">:</span> <span class="n">email</span><span class="p">})</span>
            <span class="n">users</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">new_user</span><span class="p">)</span>

            <span class="n">flash</span><span class="p">(</span><span class="s1">'Thanks! Email confirmed, you can now log in'</span><span class="p">,</span> <span class="s1">'success'</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">tries</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s2">"nb_try_code_on_creation"</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">new</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"$set"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"nb_try_code_on_creation"</span><span class="p">:</span> <span class="n">tries</span><span class="p">}}</span>
            <span class="n">unverified_users</span><span class="o">.</span><span class="n">update_one</span><span class="p">({</span><span class="s2">"email"</span><span class="p">:</span> <span class="n">email</span><span class="p">},</span> <span class="n">new</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'user/confirm_code.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.confirm_email" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confirm_email</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the email confirmation process for new users.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>token</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The confirmation token sent to the user's email.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the index page after confirming the email.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/confirm/&lt;token&gt;'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">confirm_email</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the email confirmation process for new users.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    token : str</span>
<span class="sd">        The confirmation token sent to the user's email.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the index page after confirming the email.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::confirm_email() ******"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">confirm_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">unverified_users</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s2">"email"</span><span class="p">:</span> <span class="n">email</span><span class="p">})</span>
        <span class="n">new_user</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">'name'</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">"name"</span><span class="p">],</span>
            <span class="s1">'surname'</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">"surname"</span><span class="p">],</span>
            <span class="s1">'email'</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">"email"</span><span class="p">],</span>
            <span class="s1">'password_hash'</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">"password_hash"</span><span class="p">],</span>
            <span class="s1">'video_history_list'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        <span class="c1"># users.insert_one(new_user)</span>
        <span class="n">unverified_users</span><span class="o">.</span><span class="n">delete_one</span><span class="p">({</span><span class="s2">"email"</span><span class="p">:</span> <span class="n">email</span><span class="p">})</span>
        <span class="n">users</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">new_user</span><span class="p">)</span>

        <span class="n">us</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
        <span class="n">login_user</span><span class="p">(</span><span class="n">us</span><span class="p">)</span>

        <span class="n">flash</span><span class="p">(</span><span class="s1">'Thanks! Email confirmed'</span><span class="p">,</span> <span class="s1">'success'</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">flash</span><span class="p">(</span><span class="s1">'The confirmation link is invalid or has expired.'</span><span class="p">,</span> <span class="s1">'danger'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.delete_annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_annotation</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Delete user-specific annotations for a video.</p>
<p>This endpoint removes all annotation data associated with a specific video
and user combination from the database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>video_id</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier of the video whose annotations should be deleted</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing user information:
- id : str
    MongoDB user identifier
- name : str 
    User's full name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- done : bool
    True if deletion successful, False if error occurred</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">"/delete_annotation"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span><span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_annotation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Delete user-specific annotations for a video.</span>

<span class="sd">    This endpoint removes all annotation data associated with a specific video</span>
<span class="sd">    and user combination from the database.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    video_id : str</span>
<span class="sd">        Unique identifier of the video whose annotations should be deleted</span>
<span class="sd">    user : dict</span>
<span class="sd">        Dictionary containing user information:</span>
<span class="sd">        - id : str</span>
<span class="sd">            MongoDB user identifier</span>
<span class="sd">        - name : str </span>
<span class="sd">            User's full name</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - done : bool</span>
<span class="sd">            True if deletion successful, False if error occurred</span>
<span class="sd">    """</span>
    <span class="n">video_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s2">"video_id"</span><span class="p">]</span>
    <span class="n">user</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"id"</span><span class="p">:</span> <span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span><span class="p">,</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="n">current_user</span><span class="o">.</span><span class="n">complete_name</span><span class="p">}</span>
    <span class="n">mongo</span><span class="o">.</span><span class="n">remove_annotations_data</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">"done"</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.delete_video" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_video</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Delete a video and its associated data from the database.</p>
<p>This endpoint handles video deletion requests. It removes the video entry
and all associated annotations from MongoDB storage.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>video_id</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier of the video to delete, passed in request JSON</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- done : bool
    True if deletion successful, False if error occurred</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/delete_video'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_video</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Delete a video and its associated data from the database.</span>

<span class="sd">    This endpoint handles video deletion requests. It removes the video entry</span>
<span class="sd">    and all associated annotations from MongoDB storage.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    video_id : str</span>
<span class="sd">        Unique identifier of the video to delete, passed in request JSON</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - done : bool</span>
<span class="sd">            True if deletion successful, False if error occurred</span>
<span class="sd">    """</span>
    <span class="n">video_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s2">"video_id"</span><span class="p">]</span>
    <span class="n">mongo</span><span class="o">.</span><span class="n">remove_video</span><span class="p">(</span><span class="n">video_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"done"</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.forgot_password" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forgot_password</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the forgot password process for users.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the forgot password page if the form is not submitted/valid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="werkzeug.wrappers.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A redirect response to the password reset page if the form is submitted and valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/forgot_password'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">forgot_password</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the forgot password process for users.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the forgot password page if the form is not submitted/valid.</span>
<span class="sd">    werkzeug.wrappers.Response</span>
<span class="sd">        A redirect response to the password reset page if the form is submitted and valid.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::forgot_password() ******"</span><span class="p">)</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">ForgotForm</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">generate_confirmation_token</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">reset_url</span> <span class="o">=</span> <span class="n">url_for</span><span class="p">(</span><span class="s1">'password_reset'</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span> <span class="n">_external</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'user/user_forgot_password_mail.html'</span><span class="p">,</span> <span class="n">reset_url</span><span class="o">=</span><span class="n">reset_url</span><span class="p">)</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="s2">"Password reset"</span>

        <span class="n">send_mail</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">html</span><span class="p">)</span>
        <span class="n">flash</span><span class="p">(</span><span class="s1">'Email sent to '</span> <span class="o">+</span> <span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">'success'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'user/forgot_password.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.get_concept_vocabulary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_concept_vocabulary</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieve concept vocabulary and their synonyms.</p>
<p>This endpoint handles requests to get synonyms for a list of concepts using NLTK Wordnet.
Accepts POST requests with JSON data containing concepts and returns a vocabulary mapping.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>concepts</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of concept strings to find synonyms for, passed in request JSON</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- conceptVocabulary : dict
    Mapping of concepts to their synonyms from Wordnet</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/get_concept_vocabulary'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_concept_vocabulary</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Retrieve concept vocabulary and their synonyms.</span>

<span class="sd">    This endpoint handles requests to get synonyms for a list of concepts using NLTK Wordnet.</span>
<span class="sd">    Accepts POST requests with JSON data containing concepts and returns a vocabulary mapping.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    concepts : list</span>
<span class="sd">        List of concept strings to find synonyms for, passed in request JSON</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - conceptVocabulary : dict</span>
<span class="sd">            Mapping of concepts to their synonyms from Wordnet</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::get_concept_vocabulary() ******"</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>

    <span class="c1"># Getting concepts:</span>
    <span class="n">concepts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"concepts"</span><span class="p">]</span>
    <span class="c1"># Finding synonyms with NLTK Wordnet:</span>
    <span class="n">conceptVocabulary</span> <span class="o">=</span> <span class="n">get_synonyms_from_list</span><span class="p">(</span><span class="n">concepts</span><span class="p">)</span>

    <span class="n">json</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">#"concepts": concepts,</span>
        <span class="s2">"conceptVocabulary"</span><span class="p">:</span> <span class="n">conceptVocabulary</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">json</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.gold_standard" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gold_standard</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create gold standard annotations from multiple annotators' work.</p>
<p>This endpoint handles the creation of consensus annotations by combining
the work of multiple annotators based on agreement thresholds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>video</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Selected video identifier from form</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotators</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selected annotator IDs from form</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agreements</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Agreement threshold for including annotations in gold standard</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the gold standard annotation set</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendered HTML template 'gold_standard.html' containing:
- video_choices : dict
    Available videos and their metadata
- form : GoldStandardForm
    Form for gold standard creation parameters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/gold_standard'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">])</span>
<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">gold_standard</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Create gold standard annotations from multiple annotators' work.</span>

<span class="sd">    This endpoint handles the creation of consensus annotations by combining</span>
<span class="sd">    the work of multiple annotators based on agreement thresholds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    video : str</span>
<span class="sd">        Selected video identifier from form</span>
<span class="sd">    annotators : list</span>
<span class="sd">        List of selected annotator IDs from form</span>
<span class="sd">    agreements : float</span>
<span class="sd">        Agreement threshold for including annotations in gold standard</span>
<span class="sd">    name : str</span>
<span class="sd">        Name for the gold standard annotation set</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Rendered HTML template 'gold_standard.html' containing:</span>
<span class="sd">        - video_choices : dict</span>
<span class="sd">            Available videos and their metadata</span>
<span class="sd">        - form : GoldStandardForm</span>
<span class="sd">            Form for gold standard creation parameters</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::gold_standard() ******"</span><span class="p">)</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">GoldStandardForm</span><span class="p">()</span>

    <span class="n">video_choices</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_graphs_info</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">c</span><span class="p">,</span> <span class="n">video_choices</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s2">"title"</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">video_choices</span><span class="p">]</span>

    <span class="c1"># WTFORM impone che tutte le scelte siano definite prima, quindi metto tutti gli annotatori possibili,</span>
    <span class="c1"># verranno poi filtrati cliccando il video</span>

    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">video_choices</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">annotator</span> <span class="ow">in</span> <span class="n">video_choices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s2">"annotators"</span><span class="p">]:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="p">(</span><span class="n">annotator</span><span class="p">[</span><span class="s2">"id"</span><span class="p">],</span> <span class="n">annotator</span><span class="p">[</span><span class="s2">"name"</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">choice</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">annotators</span><span class="o">.</span><span class="n">choices</span><span class="p">:</span>
                <span class="n">form</span><span class="o">.</span><span class="n">annotators</span><span class="o">.</span><span class="n">choices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>
        <span class="n">create_gold</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">form</span><span class="o">.</span><span class="n">annotators</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">form</span><span class="o">.</span><span class="n">agreements</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">form</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'gold_standard.html'</span><span class="p">,</span>  <span class="n">video_choices</span><span class="o">=</span><span class="n">video_choices</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">index</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Render the index page.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the index page.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Render the index page.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the index page.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.lemmatize_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lemmatize_term</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lemmatize a term in the specified language.</p>
<p>This endpoint processes a concept term to extract its semantic structure
and returns the lemmatized form along with linguistic information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>language</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Language code for lemmatization</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concept</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Term to be lemmatized</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- text : str
    Original input text
- lemma : str
    Lemmatized form of the text
- pos : str
    Part of speech tag
- dep : str
    Dependency relation
- head : str
    Head word in dependency relation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/lemmatize_term'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">lemmatize_term</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Lemmatize a term in the specified language.</span>

<span class="sd">    This endpoint processes a concept term to extract its semantic structure</span>
<span class="sd">    and returns the lemmatized form along with linguistic information.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    language : str</span>
<span class="sd">        Language code for lemmatization</span>
<span class="sd">    concept : str</span>
<span class="sd">        Term to be lemmatized</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - text : str</span>
<span class="sd">            Original input text</span>
<span class="sd">        - lemma : str</span>
<span class="sd">            Lemmatized form of the text</span>
<span class="sd">        - pos : str</span>
<span class="sd">            Part of speech tag</span>
<span class="sd">        - dep : str</span>
<span class="sd">            Dependency relation</span>
<span class="sd">        - head : str</span>
<span class="sd">            Head word in dependency relation</span>
<span class="sd">    """</span>
    <span class="n">language</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s2">"lang"</span><span class="p">]</span>
    <span class="n">concept</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s2">"concept"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">SemanticText</span><span class="p">(</span><span class="n">concept</span><span class="p">,</span><span class="n">language</span><span class="p">)</span><span class="o">.</span><span class="n">get_semantic_structure_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.login" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">login</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the login process for users.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the login page if the user is not authenticated or the form is not submitted/valid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="werkzeug.wrappers.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A redirect response to the next page if the user is authenticated or the form is submitted and valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the login process for users.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the login page if the user is not authenticated or the form is not submitted/valid.</span>
<span class="sd">    werkzeug.wrappers.Response</span>
<span class="sd">        A redirect response to the next page if the user is authenticated or the form is submitted and valid.</span>
<span class="sd">    """</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
        <span class="n">next_page</span> <span class="o">=</span> <span class="n">url_for</span><span class="p">(</span><span class="s1">'index'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">next_page</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_submitted</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">login_user</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">remember</span><span class="o">=</span><span class="n">form</span><span class="o">.</span><span class="n">remember_me</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">next_page</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'next'</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page</span> <span class="ow">or</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">next_page</span><span class="p">)</span><span class="o">.</span><span class="n">netloc</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">:</span>
                <span class="n">next_page</span> <span class="o">=</span> <span class="n">url_for</span><span class="p">(</span><span class="s1">'index'</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">next_page</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'user/login.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.logout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logout</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the logout process for users.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the index page after logging out the user.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/logout'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the logout process for users.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the index page after logging out the user.</span>
<span class="sd">    """</span>
    <span class="n">logout_user</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.password_reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">password_reset</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the password reset process for users.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>token</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The password reset token sent to the user's email.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the password reset page if the form is not submitted/valid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="werkzeug.wrappers.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A redirect response to the index page if the token is invalid or expired.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/password_reset/&lt;token&gt;'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">password_reset</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the password reset process for users.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    token : str</span>
<span class="sd">        The password reset token sent to the user's email.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the password reset page if the form is not submitted/valid.</span>
<span class="sd">    werkzeug.wrappers.Response</span>
<span class="sd">        A redirect response to the index page if the token is invalid or expired.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::password_reset() ******"</span><span class="p">)</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">PasswordResetForm</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">confirm_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>
            <span class="n">hashpass</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">),</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">())</span>
            <span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashpass</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf8'</span><span class="p">)</span>
            <span class="n">mongo</span><span class="o">.</span><span class="n">reset_password</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">password_hash</span><span class="p">)</span>
            <span class="n">flash</span><span class="p">(</span><span class="s1">'Password updated'</span><span class="p">,</span> <span class="s1">'success'</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'user/password_reset.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="n">flash</span><span class="p">(</span><span class="s1">'The link is invalid or has expired.'</span><span class="p">,</span> <span class="s1">'danger'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.prepare_annotated_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_annotated_graph</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prepare concept graph annotations for download in JSON-LD format.</p>
<p>This endpoint receives annotation data, converts it to JSON-LD format with SKOS vocabulary,
and prepares it for client-side download. The function creates a collection of concepts
and their relationships in a standardized semantic web format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>annotations</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON data containing:
- id : str
    Video identifier 
- conceptVocabulary : dict
    Dictionary mapping concepts to their vocabulary
- language : str
    Language code for the annotations</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON-LD formatted data containing:
- @context : dict
    JSON-LD context definitions
- @graph : list
    List of nodes in the concept graph including:
    - Concept definitions
    - Relationships
    - SKOS vocabulary collection</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/download_graph'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">prepare_annotated_graph</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Prepare concept graph annotations for download in JSON-LD format.</span>

<span class="sd">    This endpoint receives annotation data, converts it to JSON-LD format with SKOS vocabulary,</span>
<span class="sd">    and prepares it for client-side download. The function creates a collection of concepts</span>
<span class="sd">    and their relationships in a standardized semantic web format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    annotations : dict</span>
<span class="sd">        JSON data containing:</span>
<span class="sd">        - id : str</span>
<span class="sd">            Video identifier </span>
<span class="sd">        - conceptVocabulary : dict</span>
<span class="sd">            Dictionary mapping concepts to their vocabulary</span>
<span class="sd">        - language : str</span>
<span class="sd">            Language code for the annotations</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON-LD formatted data containing:</span>
<span class="sd">        - @context : dict</span>
<span class="sd">            JSON-LD context definitions</span>
<span class="sd">        - @graph : list</span>
<span class="sd">            List of nodes in the concept graph including:</span>
<span class="sd">            - Concept definitions</span>
<span class="sd">            - Relationships</span>
<span class="sd">            - SKOS vocabulary collection</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::download_graph(): Inizio ******"</span><span class="p">)</span>

    <span class="n">annotations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">json</span> <span class="o">=</span> <span class="n">annotations_to_jsonLD</span><span class="p">(</span><span class="n">annotations</span><span class="p">,</span><span class="n">isAutomatic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">conceptVocabulary</span> <span class="o">=</span> <span class="n">create_skos_dictionary</span><span class="p">(</span><span class="n">annotations</span><span class="p">[</span><span class="s2">"conceptVocabulary"</span><span class="p">],</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"id"</span><span class="p">],</span> <span class="s2">"manu"</span><span class="p">,</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"language"</span><span class="p">])</span>

    <span class="n">json</span><span class="p">[</span><span class="s2">"graph"</span><span class="p">][</span><span class="s2">"@graph"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span> <span class="s2">"id"</span><span class="p">:</span><span class="s2">"localVocabulary"</span><span class="p">,</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"skos:Collection"</span><span class="p">,</span><span class="s2">"skos:member"</span><span class="p">:</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">conceptVocabulary</span><span class="p">[</span><span class="s2">"@graph"</span><span class="p">]]})</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"@context"</span><span class="p">:</span> <span class="n">conceptVocabulary</span><span class="p">[</span><span class="s2">"@context"</span><span class="p">],</span>
        <span class="s2">"@graph"</span><span class="p">:</span> <span class="n">json</span><span class="p">[</span><span class="s2">"graph"</span><span class="p">][</span><span class="s2">"@graph"</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::download_annotated_graph(): Fine ******"</span><span class="p">)</span>
    <span class="c1"># real download happens on the js side</span>
    <span class="k">return</span> <span class="n">result</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle the registration process for new users.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered HTML content of the registration page if the form is not submitted/valid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="werkzeug.wrappers.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A redirect response to the confirmation code page if the form is submitted and valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/register'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle the registration process for new users.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The rendered HTML content of the registration page if the form is not submitted/valid.</span>
<span class="sd">    werkzeug.wrappers.Response</span>
<span class="sd">        A redirect response to the confirmation code page if the form is submitted and valid.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: db_mongo.py::register() ******"</span><span class="p">)</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">RegisterForm</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">),</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">())</span>
        <span class="n">password_hash</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf8'</span><span class="p">)</span>

        <span class="c1"># generate a random string of lenght N composed of lowercase letters and numbers</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">hashed_code</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">),</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">())</span>
        <span class="n">code_on_creation_hash</span> <span class="o">=</span> <span class="n">hashed_code</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf8'</span><span class="p">)</span>

        <span class="n">new_user</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">'name'</span><span class="p">:</span> <span class="n">form</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="s1">'surname'</span><span class="p">:</span> <span class="n">form</span><span class="o">.</span><span class="n">surname</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="s1">'email'</span><span class="p">:</span> <span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="s1">'password_hash'</span><span class="p">:</span> <span class="n">password_hash</span><span class="p">,</span>
            <span class="s1">'code_on_creation_hash'</span><span class="p">:</span> <span class="n">code_on_creation_hash</span><span class="p">,</span>
            <span class="s1">'nb_try_code_on_creation'</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>

        <span class="n">unverified_users</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">new_user</span><span class="p">)</span>

        <span class="n">send_confirmation_mail</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>


        <span class="n">mail</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">next_page</span> <span class="o">=</span> <span class="n">url_for</span><span class="p">(</span><span class="s1">'confirm_code'</span><span class="p">,</span> <span class="n">mail</span><span class="o">=</span><span class="n">mail</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">next_page</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'user/register.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.upload_annotated_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_annotated_graph</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Upload and store annotated concept graph in JSON-LD format.</p>
<p>This endpoint receives annotation data for a video, converts it to JSON-LD format,
and stores it in MongoDB. The annotations include concept relationships, vocabulary,
and metadata about the annotation process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>annotations</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON data containing:
- id : str
    Video identifier
- conceptVocabulary : dict
    Mapping of concepts to synonyms
- language : str
    Language of annotations
- is_completed : bool
    Whether annotation is complete</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- done : bool
    True if upload successful, False if error occurred</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/upload_graph'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload_annotated_graph</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Upload and store annotated concept graph in JSON-LD format.</span>

<span class="sd">    This endpoint receives annotation data for a video, converts it to JSON-LD format,</span>
<span class="sd">    and stores it in MongoDB. The annotations include concept relationships, vocabulary,</span>
<span class="sd">    and metadata about the annotation process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    annotations : dict</span>
<span class="sd">        JSON data containing:</span>
<span class="sd">        - id : str</span>
<span class="sd">            Video identifier</span>
<span class="sd">        - conceptVocabulary : dict</span>
<span class="sd">            Mapping of concepts to synonyms</span>
<span class="sd">        - language : str</span>
<span class="sd">            Language of annotations</span>
<span class="sd">        - is_completed : bool</span>
<span class="sd">            Whether annotation is complete</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - done : bool</span>
<span class="sd">            True if upload successful, False if error occurred</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::upload_annotations(): Inizio ******"</span><span class="p">)</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">annotations_to_jsonLD</span><span class="p">(</span><span class="n">annotations</span><span class="p">,</span><span class="n">isAutomatic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">"video_id"</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">"annotator_id"</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">"annotator_name"</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">complete_name</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">"email"</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">email</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">"conceptVocabulary"</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_skos_dictionary</span><span class="p">(</span><span class="n">annotations</span><span class="p">[</span><span class="s2">"conceptVocabulary"</span><span class="p">],</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"id"</span><span class="p">],</span> <span class="s2">"manu"</span><span class="p">,</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"language"</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">"annotation_completed"</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"is_completed"</span><span class="p">]</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">"graph"</span><span class="p">][</span><span class="s2">"@graph"</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([{</span><span class="s2">"id"</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">"id"</span><span class="p">],</span> <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"skos:Concept"</span><span class="p">}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">"conceptVocabulary"</span><span class="p">][</span><span class="s2">"@graph"</span><span class="p">]])</span>


    <span class="c1"># inserting annotations on DB</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">mongo</span><span class="o">.</span><span class="n">insert_graph</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>    
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">flash</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="s2">"error"</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">"done"</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::upload_annotations(): Fine ******"</span><span class="p">)</span>
    <span class="c1"># TODO show a message on screen</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"done"</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.video_segmentation_refinement" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">video_segmentation_refinement</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Refine video segmentation and update concept definitions.</p>
<p>This endpoint processes video segments to refine concept definitions
and timestamps, storing updated annotations in the database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON request data containing:
- id : str
    Video identifier
- conceptVocabulary : dict
    Mapping of concepts to synonyms
- definitions : dict
    Current concept definitions with timestamps
- concept_map : dict
    Current concept relationships</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response containing:
- definitions : dict
    Updated concept definitions with refined timestamps
- downloadable_jsonld_graph : dict
    JSON-LD formatted graph containing:
    - @context : dict
        JSON-LD context definitions
    - @graph : list
        Updated nodes including:
        - Concept definitions
        - Relationships
        - SKOS vocabulary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/refinement'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">video_segmentation_refinement</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Refine video segmentation and update concept definitions.</span>

<span class="sd">    This endpoint processes video segments to refine concept definitions</span>
<span class="sd">    and timestamps, storing updated annotations in the database.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict </span>
<span class="sd">        JSON request data containing:</span>
<span class="sd">        - id : str</span>
<span class="sd">            Video identifier</span>
<span class="sd">        - conceptVocabulary : dict</span>
<span class="sd">            Mapping of concepts to synonyms</span>
<span class="sd">        - definitions : dict</span>
<span class="sd">            Current concept definitions with timestamps</span>
<span class="sd">        - concept_map : dict</span>
<span class="sd">            Current concept relationships</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        JSON response containing:</span>
<span class="sd">        - definitions : dict</span>
<span class="sd">            Updated concept definitions with refined timestamps</span>
<span class="sd">        - downloadable_jsonld_graph : dict</span>
<span class="sd">            JSON-LD formatted graph containing:</span>
<span class="sd">            - @context : dict</span>
<span class="sd">                JSON-LD context definitions</span>
<span class="sd">            - @graph : list</span>
<span class="sd">                Updated nodes including:</span>
<span class="sd">                - Concept definitions</span>
<span class="sd">                - Relationships</span>
<span class="sd">                - SKOS vocabulary</span>
<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>
    <span class="n">video_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span>
    <span class="n">concept_vocabulary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"conceptVocabulary"</span><span class="p">]</span>

    <span class="c1"># for design this should not return None</span>
    <span class="n">video</span> <span class="o">=</span> <span class="n">VideoAnalyzer</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span> <span class="p">{</span><span class="s2">"language"</span><span class="p">})</span>
    <span class="n">new_concepts</span><span class="p">,</span><span class="n">definitions</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">adjust_or_insert_definitions_and_indepth_times</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"definitions"</span><span class="p">],</span><span class="n">_show_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">#from pprint import pprint</span>
    <span class="c1">#pprint(definitions)</span>
    <span class="n">_</span><span class="p">,</span><span class="n">burst_graph</span> <span class="o">=</span> <span class="n">create_burst_graph</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">definitions</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s2">"concept_map"</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">local_vocabulary</span> <span class="o">=</span> <span class="n">create_local_vocabulary</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">concept_vocabulary</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">flash</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="s1">'message'</span><span class="p">)</span>
    <span class="n">skos_concepts</span> <span class="o">=</span> <span class="n">local_vocabulary</span><span class="p">[</span><span class="s2">"skos:member"</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_concepts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">skos_concepts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">convert_to_skos_concepts</span><span class="p">(</span><span class="n">new_concepts</span><span class="p">,</span><span class="n">concept_vocabulary</span><span class="p">,</span><span class="n">video</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"language"</span><span class="p">]))</span>
    <span class="n">downloadable_jsonld_graph</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"@context"</span><span class="p">:</span><span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@context"</span><span class="p">],</span><span class="s2">"@graph"</span><span class="p">:</span><span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@graph"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">+</span><span class="p">[</span><span class="n">local_vocabulary</span><span class="p">]}</span>
    <span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@graph"</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([{</span><span class="s2">"id"</span><span class="p">:</span><span class="n">concept</span><span class="p">[</span><span class="s2">"id"</span><span class="p">],</span><span class="s2">"type"</span><span class="p">:</span><span class="n">concept</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]}</span> <span class="k">for</span> <span class="n">concept</span> <span class="ow">in</span> <span class="n">skos_concepts</span><span class="p">])</span>

    <span class="n">mongo</span><span class="o">.</span><span class="n">insert_graph</span><span class="p">({</span> <span class="s2">"video_id"</span><span class="p">:</span><span class="n">video_id</span><span class="p">,</span>
                            <span class="s2">"annotator_id"</span><span class="p">:</span><span class="n">current_user</span><span class="o">.</span><span class="n">complete_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span><span class="s2">"_"</span><span class="p">)</span><span class="o">+</span><span class="s2">"_Burst_Analysis"</span><span class="p">,</span>
                            <span class="s2">"annotator_name"</span><span class="p">:</span><span class="s2">"Burst_Analysis"</span><span class="p">,</span>
                            <span class="s2">"email"</span><span class="p">:</span><span class="s2">"Burst_Analysis"</span><span class="p">,</span>
                            <span class="s2">"graph"</span><span class="p">:</span> <span class="n">burst_graph</span><span class="p">,</span>
                            <span class="s2">"conceptVocabulary"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"@context"</span><span class="p">:</span> <span class="n">burst_graph</span><span class="p">[</span><span class="s2">"@context"</span><span class="p">],</span> <span class="s2">"@graph"</span><span class="p">:</span> <span class="n">skos_concepts</span><span class="p">}})</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">"definitions"</span><span class="p">:</span><span class="n">definitions</span><span class="p">,</span>
            <span class="s2">"downloadable_jsonld_graph"</span><span class="p">:</span><span class="n">downloadable_jsonld_graph</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="/home/runner/work/ekeel/ekeel/EVA_apps.EKEELVideoAnnotation.main.video_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">video_selection</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle video selection and processing for annotation purposes.</p>
<p>This function manages the video selection interface and processes new video submissions.
It handles both GET requests to display the video selection page and POST requests to 
process new video submissions. For new videos, it:</p>
<ul>
<li>
<p>Downloads the video</p>
</li>
<li>
<p>Extracts and processes the transcript</p>
</li>
<li>
<p>Segments the video</p>
</li>
<li>
<p>Creates thumbnails</p>
</li>
<li>
<p>Processes concepts and vocabulary</p>
</li>
<li>
<p>Sets up the annotation environment</p>
</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL of the video to be processed (from addVideoForm)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On GET or failed form validation: renders video_selection.html template
showing existing videos and upload form</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="werkzeug.wrappers.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On successful POST: renders mooc_annotator.html template with processed
video data and annotation interface</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>EVA_apps/EKEELVideoAnnotation/main.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/video_selection'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">])</span>
<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">video_selection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Handle video selection and processing for annotation purposes.</span>

<span class="sd">    This function manages the video selection interface and processes new video submissions.</span>
<span class="sd">    It handles both GET requests to display the video selection page and POST requests to </span>
<span class="sd">    process new video submissions. For new videos, it:</span>

<span class="sd">    - Downloads the video</span>

<span class="sd">    - Extracts and processes the transcript</span>

<span class="sd">    - Segments the video</span>

<span class="sd">    - Creates thumbnails</span>

<span class="sd">    - Processes concepts and vocabulary</span>

<span class="sd">    - Sets up the annotation environment</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    url : str</span>
<span class="sd">        URL of the video to be processed (from addVideoForm)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        On GET or failed form validation: renders video_selection.html template</span>
<span class="sd">        showing existing videos and upload form</span>
<span class="sd">    werkzeug.wrappers.Response</span>
<span class="sd">        On successful POST: renders mooc_annotator.html template with processed</span>
<span class="sd">        video data and annotation interface</span>

<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::video_selection(): Inizio ******"</span><span class="p">)</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">addVideoForm</span><span class="p">()</span>
    <span class="n">videos</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_videos</span><span class="p">([</span><span class="s2">"video_id"</span><span class="p">,</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"creator"</span><span class="p">])</span>
    <span class="n">annotator</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span>
    <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="n">videos</span><span class="p">:</span>
        <span class="n">annotation_status</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_annotation_status</span><span class="p">(</span><span class="n">annotator</span><span class="p">,</span> <span class="n">video</span><span class="p">[</span><span class="s2">"video_id"</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">annotation_status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">annotation_status</span> <span class="o">=</span> <span class="s2">"None"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">annotation_status</span> <span class="o">=</span> <span class="s2">"Completed"</span> <span class="k">if</span> <span class="n">annotation_status</span><span class="p">[</span><span class="s2">"annotation_completed"</span><span class="p">]</span> <span class="k">else</span> <span class="s2">"Progressing"</span>
        <span class="n">video</span><span class="p">[</span><span class="s2">"annotation_status"</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation_status</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'video_selection.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">videos</span><span class="o">=</span><span class="n">videos</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">data</span>
        <span class="n">vid_analyzer</span> <span class="o">=</span> <span class="n">VideoAnalyzer</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">download_video</span><span class="p">()</span>

        <span class="c1"># NOTE extracting transcript from audio with whisper on high-end i9 8 core process at ~1.3 sec/s</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">request_transcript</span><span class="p">()</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">analyze_transcript</span><span class="p">()</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">request_terms</span><span class="p">()</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">filter_terms</span><span class="p">()</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">transcript_segmentation</span><span class="p">()</span>
        <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">create_thumbnails</span><span class="p">()</span>
        <span class="c1">#vid_analyzer.analyze_video()  for now we don't extract slides</span>
        <span class="n">video_id</span> <span class="o">=</span> <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">video_id</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">data</span>

        <span class="n">language</span> <span class="o">=</span> <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">identify_language</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">SemanticText</span><span class="p">(</span><span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timed_sentence</span><span class="p">[</span><span class="s2">"text"</span><span class="p">]</span> <span class="k">for</span> <span class="n">timed_sentence</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"text"</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="s2">"["</span> <span class="ow">in</span> <span class="n">timed_sentence</span><span class="p">[</span><span class="s1">'text'</span><span class="p">]),</span> <span class="n">language</span><span class="p">)</span>
        <span class="n">conll_sentences</span> <span class="o">=</span> <span class="n">conll_gen</span><span class="p">(</span><span class="n">video_id</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">language</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"is_whisper_transcribed"</span><span class="p">]:</span>
            <span class="c1">#lemmatized_subtitles, all_lemmas = html_interactable_transcript_word_level(data["transcript_data"]["text"], language)</span>
            <span class="c1">#all_lemmas = vid_analyzer.data["transcript_data"]["lemmas"]</span>
            <span class="n">lemmatized_subtitles</span> <span class="o">=</span> <span class="n">html_interactable_transcript_word_level</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"text"</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lemmatized_subtitles</span><span class="p">,</span> <span class="n">all_lemmas</span> <span class="o">=</span> <span class="n">html_interactable_transcript_legacy</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"text"</span><span class="p">],</span> <span class="n">conll_sentences</span><span class="p">,</span> <span class="n">language</span><span class="p">)</span>
        <span class="n">annotator</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">complete_name</span>
        <span class="n">relations</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_concept_map</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>
        <span class="n">definitions</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_definitions</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>
        <span class="n">completed_graph</span> <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_annotation_status</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>
        <span class="n">marked_completed</span> <span class="o">=</span> <span class="n">completed_graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">completed_graph</span><span class="p">[</span><span class="s2">"annotation_completed"</span><span class="p">]</span>

        <span class="c1"># Obtaining concept vocabulary from DB</span>
        <span class="n">conceptVocabulary</span>  <span class="o">=</span> <span class="n">mongo</span><span class="o">.</span><span class="n">get_vocabulary</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">mongodb_id</span><span class="p">,</span> <span class="n">video_id</span><span class="p">)</span>

        <span class="c1"># If the concept vocabulary is in the DB then initialize concept to the ones of the vocabulary</span>
        <span class="k">if</span> <span class="n">conceptVocabulary</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">conceptVocabulary</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">conceptVocabulary</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">lemmatized_concepts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sem_text</span> <span class="o">=</span> <span class="n">SemanticText</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">language</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">concept</span> <span class="ow">in</span> <span class="n">conceptVocabulary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lemmatized_concepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sem_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">concept</span><span class="p">)</span><span class="o">.</span><span class="n">get_semantic_structure_info</span><span class="p">())</span>

        <span class="c1"># If the concept vocabulary is new (empty) in DB then initialize it from the terms extracted</span>
        <span class="k">if</span> <span class="n">conceptVocabulary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lemmatized_concepts</span> <span class="o">=</span> <span class="p">[</span><span class="n">SemanticText</span><span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="s2">"term"</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">term</span><span class="p">[</span><span class="s2">"term"</span><span class="p">]</span><span class="o">.</span><span class="n">istitle</span><span class="p">()</span> <span class="k">else</span> <span class="n">term</span><span class="p">[</span><span class="s2">"term"</span><span class="p">],</span><span class="n">language</span><span class="p">)</span><span class="o">.</span><span class="n">get_semantic_structure_info</span><span class="p">()</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">vid_analyzer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"terms"</span><span class="p">]]</span>
            <span class="c1">#-----------------------------------------------------------------</span>
            <span class="c1"># 1) Automatically obtain synonyms using wordnet NLTK</span>
            <span class="c1">#</span>
            <span class="c1">#conceptVocabulary = get_synonyms_from_list(lemmatized_concepts)</span>
            <span class="c1"># 2) Start with empty synonyms in concept vocabulary</span>
            <span class="c1">#</span>
            <span class="n">conceptVocabulary</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">concept</span> <span class="ow">in</span> <span class="n">lemmatized_concepts</span> <span class="p">:</span>
                <span class="n">conceptVocabulary</span><span class="p">[</span><span class="n">concept</span><span class="p">[</span><span class="s2">"text"</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1">#-----------------------------------------------------------------</span>
        <span class="c1"># This shouldn't happen but in case of different versions of annotations is kept for compatibility</span>
        <span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="n">relations</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rel</span><span class="p">[</span><span class="s2">"prerequisite"</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conceptVocabulary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lemmatized_concepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SemanticText</span><span class="p">(</span><span class="n">rel</span><span class="p">[</span><span class="s2">"prerequisite"</span><span class="p">],</span><span class="n">language</span><span class="p">)</span><span class="o">.</span><span class="n">get_semantic_structure_info</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">rel</span><span class="p">[</span><span class="s2">"target"</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conceptVocabulary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lemmatized_concepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SemanticText</span><span class="p">(</span><span class="n">rel</span><span class="p">[</span><span class="s2">"target"</span><span class="p">],</span><span class="n">language</span><span class="p">)</span><span class="o">.</span><span class="n">get_semantic_structure_info</span><span class="p">())</span>

        <span class="n">NLPSingleton</span><span class="p">()</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  

        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'mooc_annotator.html'</span><span class="p">,</span> 
                               <span class="n">result</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"text"</span><span class="p">],</span> <span class="n">video_id</span><span class="o">=</span><span class="n">video_id</span><span class="p">,</span> <span class="n">start_times</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s2">"video_data"</span><span class="p">][</span><span class="s2">"segments"</span><span class="p">])),</span>
                               <span class="n">images_path</span><span class="o">=</span><span class="n">vid_analyzer</span><span class="o">.</span><span class="n">images_path</span><span class="p">,</span> <span class="n">concepts</span><span class="o">=</span><span class="n">lemmatized_concepts</span><span class="p">,</span><span class="n">is_temp_transcript</span><span class="o">=</span><span class="ow">not</span> <span class="n">data</span><span class="p">[</span><span class="s2">"transcript_data"</span><span class="p">][</span><span class="s2">"is_whisper_transcribed"</span><span class="p">],</span>
                               <span class="n">video_duration</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">'duration'</span><span class="p">],</span> <span class="n">lemmatized_subtitles</span><span class="o">=</span><span class="n">lemmatized_subtitles</span><span class="p">,</span> <span class="n">annotator</span><span class="o">=</span><span class="n">annotator</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">is_completed</span><span class="o">=</span><span class="n">marked_completed</span><span class="p">,</span>
                               <span class="n">conceptVocabulary</span><span class="o">=</span><span class="n">conceptVocabulary</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">'title'</span><span class="p">],</span> <span class="n">relations</span><span class="o">=</span><span class="n">relations</span><span class="p">,</span> <span class="n">definitions</span><span class="o">=</span><span class="n">definitions</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">sys</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">import</span> <span class="nn">traceback</span>

        <span class="n">tb_details</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">extract_tb</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\033</span><span class="s2">[91mException in video selection: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">tb_details</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="c1"># Read the specific line of code</span>
            <span class="n">line_number</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">lineno</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="n">error_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">line_number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\033</span><span class="s2">[91mFile: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">, Function: </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, Line: </span><span class="si">{</span><span class="n">line_number</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">error_line</span><span class="si">}</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">)</span>
        <span class="n">flash</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"Danger"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"***** EKEEL - Video Annotation: main.py::video_selection(): Fine ******"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">'video_selection.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">videos</span><span class="o">=</span><span class="n">videos</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="about:void" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://ekeel.dibris.unige.it/" target="_blank" rel="noopener" title="ekeel.dibris.unige.it" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M162.4 196c4.8-4.9 6.2-5.1 36.4-5.1 27.2 0 28.1.1 32.1 2.1 5.8 2.9 8.3 7 8.3 13.6 0 5.9-2.4 10-7.6 13.4-2.8 1.8-4.5 1.9-31.1 2.1-16.4.1-29.5-.2-31.5-.8-10.3-2.9-14.1-17.7-6.6-25.3m61.4 94.5c-53.9 0-55.8.2-60.2 4.1-3.5 3.1-5.7 9.4-5.1 13.9.7 4.7 4.8 10.1 9.2 12 2.2 1 14.1 1.7 56.3 1.2l47.9-.6 9.2-1.5c9-5.1 10.5-17.4 3.1-24.4-5.3-4.7-5-4.7-60.4-4.7m223.4 130.1c-3.5 28.4-23 50.4-51.1 57.5-7.2 1.8-9.7 1.9-172.9 1.8-157.8 0-165.9-.1-172-1.8-8.4-2.2-15.6-5.5-22.3-10-5.6-3.8-13.9-11.8-17-16.4-3.8-5.6-8.2-15.3-10-22S0 420.3 0 256.3C0 93.2 0 89.7 1.8 82.6 8.1 57.9 27.7 39 53 33.4c7.3-1.6 332.1-1.9 340-.3 21.2 4.3 37.9 17.1 47.6 36.4 7.7 15.3 7-1.5 7.3 180.6.2 115.8 0 164.5-.7 170.5m-85.4-185.2c-1.1-5-4.2-9.6-7.7-11.5-1.1-.6-8-1.3-15.5-1.7-12.4-.6-13.8-.8-17.8-3.1-6.2-3.6-7.9-7.6-8-18.3 0-20.4-8.5-39.4-25.3-56.5-12-12.2-25.3-20.5-40.6-25.1-3.6-1.1-11.8-1.5-39.2-1.8-42.9-.5-52.5.4-67.1 6.2-27 10.7-46.3 33.4-53.4 62.4-1.3 5.4-1.6 14.2-1.9 64.3-.4 62.8 0 72.1 4 84.5 9.7 30.7 37.1 53.4 64.6 58.4 9.2 1.7 122.2 2.1 133.7.5 20.1-2.7 35.9-10.8 50.7-25.9 10.7-10.9 17.4-22.8 21.8-38.5 3.2-10.9 2.9-88.4 1.7-93.9"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.top", "navigation.tabs", "navigation.instant", "content.code.annotate", "content.code.copy", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>